<div class="modal-header">
  <h4 class="modal-title" id="modal-basic-title">{{"modals.downloads.title" | transloco: {type: "Download results by {{type}}"} }}</h4>
  <button type="button" class="btn-close" aria-label="Close" (click)="activeModal.close('Cross click')"></button>
</div>
<div class="modal-body">
  <p style="text-align: justify" [innerHTML]="'modals.downloads.introduction' | transloco"></p>
  <p [innerHTML]="'modals.downloads.latest result' | transloco"></p>
  <p>{{ 'modals.downloads.add conversions' | transloco }}:</p>
  <div>
    @for (conversion of converters; track conversion.obj.name; let i = $index) {
      <div class="conversion">
        <input
          (change)="state = 'inactive'; archiveURL = ''"
          [(ngModel)]="checkboxes[i]"
          [attr.id]="'check-' + i"
          [name]="conversion.obj.name"
          class="conversion-check"
          type="checkbox"
        />
        <label [attr.for]="'check-' + i">
          <i [ngStyle]="{ color: conversion.color }" class="bi bi-file-text"></i>
          {{ conversion.obj.name }} ({{ conversion.obj.extensions[0] }})</label
        >
      </div>
    }
    <div class="clearfix"></div>
  </div>
  <br />
  @if (state === 'inactive') {
    <button (click)="process()" class="btn btn-outline-primary" style="width: 100%">{{ 'modals.downloads.get package' | transloco }}</button>
  }
  @if (state === 'processing') {
    <a [attr.disabled]="true" class="btn btn-outline-info" style="width: 100%">
      <div class="spinner-border m-5" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      {{ 'p.please wait' | transloco }}...
    </a>
  }
  @if (state === 'finished') {
    <a [attr.download]="archiveName" [attr.href]="archiveURL" class="btn btn-outline-success" (click)="showRemoveLine = true" style="width: 100%">
      {{ 'g.download' | transloco | uppercase }}
    </a>
  }
  @if (type === 'line' && state === 'finished' && showRemoveLine) {
    <p class="mt-3 text-center">{{ 'g.optional' | transloco }}:</p>
    <button (click)="removeSelected()" class="btn btn-outline-danger" id="remove-check" style="width: 100%">
      {{ 'modals.downloads.remove selected lines' | transloco }}
    </button>
  }
</div>
<div class="modal-footer">
  <button type="button" class="btn btn-outline-secondary" (click)="activeModal.close()">{{ 'g.close' | transloco }}</button>
</div>
